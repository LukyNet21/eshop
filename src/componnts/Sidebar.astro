---
import { eq } from "drizzle-orm";
import { db } from "../db/index";
import { categories_table } from "../db/schema";
const globalCategories = await db
  .select()
  .from(categories_table)
  .where(eq(categories_table.parrentId, 1));
---

<aside>
  <button id="sidebar-toggle"
    >Zobrazit kategorie <svg
      id="sidebar-toggle-svg"
      xmlns="http://www.w3.org/2000/svg"
      width="24"
      height="24"
      viewBox="0 0 24 24"
      fill="none"
      stroke="currentColor"
      stroke-width="2.25"
      stroke-linecap="round"
      stroke-linejoin="round"
    >
      <path d="m9 18 6-6-6-6"></path>
    </svg></button
  >
  <nav class="categories" id="sidebar-content">
    {
      globalCategories.map((cat) => (
        <a href={"/categories/" + cat.slug}>
          <span>{cat.name}</span>
          <svg
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="currentColor"
            stroke-width="2.25"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="m9 18 6-6-6-6" />
          </svg>
        </a>
      ))
    }
  </nav>
</aside>

<script>
  let state = false;
  const button = document.getElementById("sidebar-toggle");
  const content = document.getElementById("sidebar-content");
  const downArrow = document.getElementById("sidebar-toggle-svg");
  console.log(downArrow?.innerHTML);
  function toggleSidebar() {
    state = !state;
    content?.classList.toggle("hidden", state);
    downArrow?.classList.toggle("down-arrow", !state);
  }
  button?.addEventListener("click", toggleSidebar);
</script>

<style>
  aside {
    padding: 1rem 0;
    background-color: var(--bg);
    width: 400px;
    display: flex;
    flex-direction: column;
    align-items: center;
  }
  button {
    border: none;
    background: transparent;
    font-size: 28px;
    padding: 1rem 0;
    display: flex;
    align-items: center;
    gap: 6px;
    cursor: pointer;
  }
  nav {
    width: 100%;
  }

  .categories {
    font-size: 20px;
    display: flex;
    flex-direction: column;
  }
  .categories a {
    color: var(--text);
    padding: 1rem 0;
    width: 100%;
    cursor: pointer;
    text-align: center;
    gap: 4px;
  }
  .categories a:hover {
    background: var(--bg-dark);
    text-decoration: none;
    color: var(--text-muted);
  }
  .categories a svg {
    transition: all 0.2s ease-in-out;
  }
  .categories a:hover svg {
    transform: translateX(10px);
  }
  .hidden {
    display: none;
  }

  .down-arrow {
    transform: rotate(90deg);
  }
</style>
